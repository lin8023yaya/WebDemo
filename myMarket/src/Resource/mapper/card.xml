<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.card">
   <!-- （拼酒）记录用户信息-->
    <insert id="saveCard" parameterType="com.ctcs.market.entity.Card">
        INSERT INTO PINJIU
        (
        word,
        url
        )
        VALUES (
        #{word},
        #{url});
    </insert>
<!-- 空气净化器的质保卡记录-->
    <insert id="savezbk" parameterType="com.ctcs.market.entity.Warrantycard">
        INSERT INTO warrantycard
        (
        name,
        tel,
        address,
        dates,
        vendorid,
        typeid
        )
        VALUES (
        #{name},
        #{tel},
        #{adress},
        #{dates},
        #{vendorid},
        #{typeid});
    </insert>


    <!-- add服务费标准或者标签费标准-->
    <insert id="servicecharge" parameterType="com.ctcs.market.entity.charge">
        INSERT  INTO charge
        (
       startpredict,
       type,
       open,
        <if test="level1!=null">level1,</if>
        <if test="level2!=null">level2,</if>
        <if test="level3!=null">level3,</if>
        <if test="level4!=null">level4,</if>
        <if test="cost1!=null">cost1,</if>
        <if test="cost2!=null">cost2,</if>
        <if test="cost3!=null">cost3,</if>
        <if test="cost4!=null">cost4,</if>
        <if test="cost5!=null">cost5,</if>
        creattime
        )VALUES (
         #{startpredict},
         #{type},
         #{open},
        <if test="level1!=null">#{level1},</if>
        <if test="level2!=null">#{level2},</if>
        <if test="level3!=null">#{level3},</if>
        <if test="level4!=null">#{level4},</if>
        <if test="cost1!=null">#{cost1},</if>
        <if test="cost2!=null">#{cost2},</if>
        <if test="cost3!=null">#{cost3},</if>
        <if test="cost4!=null">#{cost4},</if>
        <if test="cost5!=null">#{cost5},</if>
        #{creattime}
        );
    </insert>
      <select id="servicelist"  resultType="com.ctcs.market.entity.charge">
          SELECT * from charge;
      </select>
    <!-- 全部设置为未开启-->
    <update id="closeall" parameterType="com.ctcs.market.entity.charge">
        UPDATE charge SET open=#{open} WHERE type=#{type}
    </update>
    <!--设置为开启-->
    <update id="openservice" parameterType="com.ctcs.market.entity.charge">
        UPDATE charge SET open=#{open} WHERE id=#{id}
    </update>

    <select id="getoneservice" parameterType="com.ctcs.market.entity.charge" resultType="com.ctcs.market.entity.charge">
        SELECT * FROM charge WHERE open=#{open} AND type=#{type}
    </select>
    <!--获取企业基本信息-->
   <select id="getvendorinfo" parameterType="com.ctcs.market.entity.charge"  resultType="Map">
       SELECT USERMOBILEPHONE,UNAME,CAPROVINCE,CACITY,CAAREA FROM T_SYS_STAFF WHERE COMPANYID=#{vendorid} AND FATHERID=-1;
   </select>
    <!-- 获取订单类型-->
    <select id="getorder" parameterType="com.ctcs.market.entity.charge"  resultType="Map">
        SELECT * FROM charge WHERE id=#{id}
    </select>

    <!-- 新增订单-->
    <insert id="addorder" parameterType="com.ctcs.market.entity.Order">
        INSERT INTO corder(
        number,
        creattime,
        type,
        level,
        count,
        totalmoney,
        vendorid,
        tel,
        name,
        address,
        chargeid
        )VALUES (
         #{number},
        #{creattime},
        #{type},
        #{level},
        #{count},
        #{totalmoney},
        #{vendorid},
        #{tel},
        #{name},
        #{address},
        #{chargeid}
        );
    </insert>
    <!-- 支付成功-->
    <update id="setpaysuccess" parameterType="com.ctcs.market.entity.Order">
        UPDATE corder SET ispay=#{ispay} WHERE number=#{number}
    </update>
    <!-- 企业查看购买记录-->
    <select id="showpayedorder" parameterType="com.ctcs.market.entity.Order" resultType="com.ctcs.market.entity.Order">
        SELECT * FROM corder WHERE vendorid=#{vendorid} AND ispay=#{ispay}
    </select>
    <!-- 管理端查看购买记录-->
    <select id="showallpayedorder"  resultType="com.ctcs.market.entity.Order" parameterType="com.ctcs.market.entity.Order">
        SELECT * FROM corder WHERE ispay=#{ispay}
    </select>

    <!-- 企业端确认收货-->
    <update id="isgetcargo" parameterType="com.ctcs.market.entity.Order">
        UPDATE corder SET isgetcargo=#{isgetcargo} WHERE id=#{id}
    </update>
    <!-- 管理端在线分配二维码-->
    <update id="isallocation" parameterType="com.ctcs.market.entity.Order">
        UPDATE corder SET isallocation=#{isallocation} WHERE id=#{id}
    </update>
    <!-- 管理端邮寄二维码-->
    <update id="ismail" parameterType="com.ctcs.market.entity.Order">
        UPDATE corder SET ismail=#{ismail} WHERE id=#{id}
    </update>

  <insert id="carlicense" parameterType="com.ctcs.market.entity.License">
         INSERT  into car_license(
         vendorid,
         typeid,
         license,
         code,
         time,
         address,
         batchid
         ) VALUES (
        #{vendorid},
        #{typeid},
        #{license},
        #{code},
        #{time},
        #{address},
        #{batchid}
         )
  </insert>



</mapper>